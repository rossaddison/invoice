"use strict";var InvoiceApp=(()=>{var A=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var j=Object.getOwnPropertyNames;var W=Object.prototype.hasOwnProperty;var G=(r,t)=>{for(var e in t)A(r,e,{get:t[e],enumerable:!0})},V=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of j(t))!W.call(r,o)&&o!==e&&A(r,o,{get:()=>t[o],enumerable:!(n=Q(t,o))||n.enumerable});return r};var J=r=>V(A({},"__esModule",{value:!0}),r);var X={};G(X,{InvoiceApp:()=>M});function d(r){if(!r)return{};if(typeof r=="object"&&r!==null)return r;if(typeof r=="string")try{return JSON.parse(r)}catch{return{}}return{}}async function m(r,t,e={}){let n=r;if(t){let a=new URLSearchParams;Object.entries(t).forEach(([c,u])=>{Array.isArray(u)?u.forEach(h=>{h!=null&&a.append(`${c}[]`,String(h))}):u!=null&&a.append(c,String(u))});let l=r.includes("?")?"&":"?";n=`${r}${l}${a.toString()}`}let o={method:"GET",credentials:"same-origin",cache:"no-store",headers:{Accept:"application/json"},...e},i=await fetch(n,o);if(!i.ok)throw new Error(`Network response not ok: ${i.status}`);let s=await i.text();try{return JSON.parse(s)}catch{return s}}function f(r,t){try{if(!r)return null;if(typeof r.closest=="function")return r.closest(t);let e=r;for(;e;){if(e.matches&&e.matches(t))return e;e=e.parentElement}}catch(e){return console.warn("closestSafe error:",e),null}return null}function Y(r){return document.getElementById(r)}function N(r){return document.querySelector(r)}function L(r){return Y(r)?.value||""}var H=class{constructor(){this.confirmButtonSelector=".create-credit-confirm";this.initialize()}initialize(){document.addEventListener("click",this.handleClick.bind(this),!0)}async handleClick(t){let e=t.target;if(!(!e||e.id!=="create-credit-confirm")){t.preventDefault();try{await this.processCreateCredit()}catch(n){console.error("Create credit error:",n),alert(`Error: ${n instanceof Error?n.message:"Unknown error"}`)}}}async processCreateCredit(){let t=`${location.origin}/invoice/inv/create_credit_confirm`,e=N(this.confirmButtonSelector),n=new URL(location.href);e&&(e.innerHTML='<h6 class="text-center"><i class="fa fa-spin fa-spinner"></i></h6>');let i={inv_id:n.href.substring(n.href.lastIndexOf("/")+1),client_id:L("client_id"),inv_date_created:L("inv_date_created"),group_id:L("inv_group_id"),password:L("inv_password"),user_id:L("user_id")},s=await m(t,i),a=d(s);a.success===1?(e&&(e.innerHTML='<h2 class="text-center"><i class="bi bi-check2-square"></i></h2>'),a.flash_message&&alert(a.flash_message),location.href=n.href,location.reload()):(e&&(e.innerHTML='<h2 class="text-center"><i class="fa fa-times"></i></h2>'),a.flash_message&&alert(a.flash_message),location.href=n.href,location.reload())}};function T(){let r=new URL(location.href);return r.href.substring(r.href.lastIndexOf("/")+1)}function p(r){return document.getElementById(r)?.value||""}function g(r,t,e){t?(r.innerHTML='<h6 class="text-center"><i class="fa fa-spin fa-spinner"></i></h6>',r.disabled=!0):(r.innerHTML=e||'<h6 class="text-center"><i class="fa fa-check"></i></h6>',r.disabled=!1)}var b=class{constructor(){this.bindEventListeners(),this.initializeComponents()}bindEventListeners(){document.addEventListener("click",this.handleClick.bind(this),!0),document.addEventListener("input",this.handleInput.bind(this),!0),document.addEventListener("focus",this.handleFocus.bind(this),!0),document.addEventListener("click",this.handleClientNoteSave.bind(this),!0),document.addEventListener("click",this.handleQuoteTaxSubmit.bind(this),!0)}handleClick(t){let e=t.target,n=e.closest(".btn_delete_item");if(n){this.handleDeleteItem(n);return}let o=e.closest(".delete-items-confirm-quote");if(o){this.handleDeleteMultipleItems(o);return}if(e.closest(".btn_add_row_modal")){this.handleAddRowModal();return}if(e.closest(".btn_quote_item_add_row")){this.handleAddQuoteItemRow();return}if(e.closest(".btn_add_row")){this.handleAddGenericRow();return}if(e.closest(".quote_add_client")){this.handleAddClientModal();return}if(e.closest("#quote_create_confirm, .quote_create_confirm")){this.handleQuoteCreateConfirm();return}let u=e.closest("#quote_with_purchase_order_number_confirm, .quote_with_purchase_order_number_confirm");if(u){this.handleQuotePurchaseOrderConfirm(u);return}let h=e.closest("#quote_to_invoice_confirm, .quote_to_invoice_confirm");if(h){this.handleQuoteToInvoiceConfirm(h);return}let E=e.closest("#quote_to_so_confirm, .quote_to_so_confirm");if(E){this.handleQuoteToSalesOrderConfirm(E);return}let _=e.closest("#quote_to_quote_confirm, .quote_to_quote_confirm");if(_){this.handleQuoteToQuoteConfirm(_);return}this.handlePdfGeneration(e)}async handleDeleteItem(t){let e=t.getAttribute("data-id");if(!e){t.closest(".item")?.remove();return}try{let n=`${location.origin}/invoice/quote/delete_item/${encodeURIComponent(e)}`,o=await m(n,{id:e}),i=d(o);i.success===1?(location.reload(),t.closest(".item")?.remove(),alert("Deleted")):console.warn("delete_item failed",i)}catch(n){console.error("delete_item error",n),alert("An error occurred while deleting item. See console for details.")}}async handleDeleteMultipleItems(t){let e=t.innerHTML;g(t,!0);try{let n=document.querySelectorAll("input[name='item_ids[]']:checked"),o=Array.from(n).map(a=>parseInt(a.value,10)).filter(Boolean),i=await m("/invoice/quoteitem/multiple",{item_ids:o}),s=d(i);s.success===1?(t.innerHTML='<h2 class="text-center"><i class="fa fa-check"></i></h2>',location.reload()):(console.warn("quoteitem/multiple failed",s),g(t,!1,e))}catch(n){console.error("quoteitem/multiple error",n),g(t,!1,e),alert("An error occurred while deleting items. See console for details.")}}async handleAddRowModal(){let t=T(),e=`${location.origin}/invoice/quoteitem/add/${encodeURIComponent(t)}`,n=document.getElementById("modal-placeholder-quoteitem");if(n)try{n.innerHTML='<h2 class="text-center"><i class="fa fa-spin fa-spinner"></i></h2>';let i=await(await fetch(e,{cache:"no-store",credentials:"same-origin"})).text();n.innerHTML=i}catch(o){console.error("Failed to load quoteitem modal",o)}}handleAddQuoteItemRow(){let t=document.getElementById("new_quote_item_row"),e=document.getElementById("item_table");if(t&&e){let n=t.cloneNode(!0);n.removeAttribute("id"),n.classList.add("item"),n.style.display="",e.appendChild(n)}}handleAddGenericRow(){let t=document.getElementById("new_row"),e=document.getElementById("item_table");if(t&&e){let n=t.cloneNode(!0);n.removeAttribute("id"),n.classList.add("item"),n.style.display="",e.appendChild(n)}}async handleAddClientModal(){let t=`${location.origin}/invoice/add-a-client`,e=document.getElementById("modal-placeholder-client");if(e)try{e.innerHTML='<h2 class="text-center"><i class="fa fa-spin fa-spinner"></i></h2>';let o=await(await fetch(t,{cache:"no-store",credentials:"same-origin"})).text();e.innerHTML=o}catch(n){console.error("Failed to load add-a-client modal",n)}}async handleQuoteCreateConfirm(){let t=`${location.origin}/invoice/quote/create_confirm`,e=document.querySelector(".quote_create_confirm"),n=e?.innerHTML||"";e&&g(e,!0);try{let o={client_id:p("create_quote_client_id"),quote_group_id:p("quote_group_id"),quote_password:p("quote_password")},i=await m(t,o),s=d(i),a=new URL(location.href);s.success===1?(e&&(e.innerHTML='<h2 class="text-center"><i class="fa fa-check"></i></h2>'),window.location.href=a.href,window.location.reload()):s.success===0&&(e&&(e.innerHTML='<h6 class="text-center"><i class="fa fa-check"></i></h6>'),window.location.href=a.href,window.location.reload(),s.message&&alert(s.message))}catch(o){console.error("create_confirm error",o),e&&g(e,!1,n),alert("An error occurred while creating quote. See console for details.")}}async handleQuotePurchaseOrderConfirm(t){let e=`${location.origin}/invoice/quote/approve`,n=document.querySelector(".quote_with_purchase_order_number_confirm")||t;n&&g(n,!0);try{let o={url_key:p("url_key"),client_po_number:p("quote_with_purchase_order_number"),client_po_person:p("quote_with_purchase_order_person")},i=await m(e,o),s=d(i),a=new URL(location.href);s.success===1&&(n&&(n.innerHTML='<h2 class="text-center"><i class="fa fa-check"></i></h2>'),window.location.href=a.href,window.location.reload())}catch(o){console.error("approve error",o),n&&g(n,!1),alert("An error occurred while approving quote. See console for details.")}}async handleQuoteToInvoiceConfirm(t){let e=`${location.origin}/invoice/quote/quote_to_invoice_confirm`,n=document.querySelector(".quote_to_invoice_confirm")||t,o=n?.innerHTML||"";n&&g(n,!0);try{let s={quote_id:T(),client_id:p("client_id"),group_id:p("group_id"),password:p("password")},a=await m(e,s),l=d(a);if(n&&(n.innerHTML='<h2 class="text-center"><i class="fa fa-check"></i></h2>'),l.success&&l.new_invoice_id)window.location.href=`${location.origin}/invoice/inv/view/${l.new_invoice_id}`;else{let c=new URL(location.href);window.location.href=c.href,window.location.reload()}l.flash_message&&alert(l.flash_message)}catch(i){console.error("quote_to_invoice_confirm error",i),n&&g(n,!1,o),alert("An error occurred while converting quote to invoice. See console for details.")}}async handleQuoteToSalesOrderConfirm(t){let e=`${location.origin}/invoice/quote/quote_to_so_confirm`,n=document.querySelector(".quote_to_so_confirm")||t,o=n?.innerHTML||"";n&&g(n,!0);try{let s={quote_id:T(),client_id:p("client_id"),group_id:p("so_group_id"),po_number:p("po_number"),po_person:p("po_person"),password:p("password")},a=await m(e,s),l=d(a),c=new URL(location.href);n&&(n.innerHTML='<h2 class="text-center"><i class="fa fa-check"></i></h2>'),window.location.href=c.href,window.location.reload(),l.flash_message&&alert(l.flash_message)}catch(i){console.error("quote_to_so_confirm error",i),n&&g(n,!1,o),alert("An error occurred while converting quote to SO. See console for details.")}}async handleQuoteToQuoteConfirm(t){let e=`${location.origin}/invoice/quote/quote_to_quote_confirm`,n=document.querySelector(".quote_to_quote_confirm")||t,o=n?.innerHTML||"";n&&g(n,!0);try{let s={quote_id:T(),client_id:p("create_quote_client_id"),user_id:p("user_id")},a=await m(e,s),l=d(a),c=new URL(location.href);l.success===1&&(n&&(n.innerHTML='<h2 class="text-center"><i class="fa fa-check"></i></h2>'),window.location.href=c.href,window.location.reload(),l.flash_message&&alert(l.flash_message))}catch(i){console.error("quote_to_quote_confirm error",i),n&&g(n,!1,o),alert("An error occurred while copying quote. See console for details.")}}handlePdfGeneration(t){if(t.closest("#quote_to_pdf_confirm_with_custom_fields")){let e=`${location.origin}/invoice/quote/pdf/1`;window.open(e,"_blank");return}if(t.closest("#quote_to_pdf_confirm_without_custom_fields")){let e=`${location.origin}/invoice/quote/pdf/0`;window.open(e,"_blank");return}}async handleClientNoteSave(t){if(!t.target.closest("#save_client_note"))return;let o=`${location.origin}/invoice/client/save_client_note`,i=`${location.origin}/invoice/client/load_client_notes`;try{let s={client_id:p("client_id"),client_note:p("client_note")},a=await m(o,s),l=d(a);if(l.success===1){document.querySelectorAll(".control-group").forEach(h=>{h.classList.remove("error")});let c=document.getElementById("client_note");c&&(c.value="");let u=document.getElementById("notes_list");if(u){let h=`${i}?client_id=${encodeURIComponent(s.client_id)}`,_=await(await fetch(h,{cache:"no-store",credentials:"same-origin"})).text();u.innerHTML=_}}else document.querySelectorAll(".control-group").forEach(c=>{c.classList.remove("error")}),l.validation_errors&&Object.keys(l.validation_errors).forEach(c=>{let u=document.getElementById(c);u?.parentElement&&u.parentElement.classList.add("has-error")})}catch(s){console.error("save_client_note error",s),alert("Status: error An error occurred")}}async handleQuoteTaxSubmit(t){let n=t.target.closest("#quote_tax_submit");if(!n)return;let o=`${location.origin}/invoice/quote/save_quote_tax_rate`,i=document.querySelector(".quote_tax_submit")||n;i&&g(i,!0);try{let a={quote_id:T(),tax_rate_id:p("tax_rate_id"),include_item_tax:p("include_item_tax")},l=await m(o,a),c=d(l),u=new URL(location.href);window.location.href=u.href,window.location.reload(),c.flash_message&&alert(c.flash_message)}catch(s){console.error("save_quote_tax_rate error",s),alert("An error occurred while saving quote tax rate. See console for details.")}}handleInput(t){let e=t.target;if(e.id==="quote_discount_amount"){let n=document.getElementById("quote_discount_percent");e.value.length>0?n&&(n.value="0.00",n.disabled=!0):n&&(n.disabled=!1)}if(e.id==="quote_discount_percent"){let n=document.getElementById("quote_discount_amount");e.value.length>0?n&&(n.value="0.00",n.disabled=!0):n&&(n.disabled=!1)}}handleFocus(t){let e=t.target;e.id==="datepicker"&&this.initializeDatepicker(e),e.classList?.contains("datepicker")&&this.initializeDatepicker(e),e.classList?.contains("taggable")&&(window.lastTaggableClicked=e)}initializeDatepicker(t){window.jQuery?.fn?.datepicker&&(t.id==="datepicker"?window.jQuery(t).datepicker({changeMonth:!0,changeYear:!0,showButtonPanel:!0,dateFormat:"dd-mm-yy"}):window.jQuery(t).datepicker({beforeShow:()=>{setTimeout(()=>{document.querySelectorAll(".datepicker").forEach(e=>{e.style.zIndex="9999"})},0)}}))}initializeComponents(){document.addEventListener("DOMContentLoaded",()=>{this.initializeTooltips(),this.initializeTagSelect()})}initializeTooltips(){typeof window.bootstrap?.Tooltip<"u"&&document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(t=>{try{new window.bootstrap.Tooltip(t)}catch{}})}initializeTagSelect(){document.querySelectorAll(".tag-select").forEach(t=>{t.addEventListener("change",n=>{let o=n.currentTarget;return window.lastTaggableClicked&&this.insertAtCaret(window.lastTaggableClicked.id,o.value),o._tomselect?.clear?o._tomselect.clear():o.tomselect?.clear?o.tomselect.clear():o.multiple?Array.from(o.options).forEach(i=>{i.selected=!1}):o.value="",n.preventDefault(),!1})})}insertAtCaret(t,e){let n=document.getElementById(t);if(!n)return;let o=n.selectionStart||0,i=n.selectionEnd||0,s=n.value;n.value=s.substring(0,o)+e+s.substring(i),n.setSelectionRange(o+e.length,o+e.length),n.focus()}};function w(r){return document.getElementById(r)?.value||""}function y(r,t,e){t?(r.innerHTML='<h6 class="text-center"><i class="fa fa-spin fa-spinner"></i></h6>',r.disabled=!0):(r.innerHTML=e||'<h6 class="text-center"><i class="fa fa-check"></i></h6>',r.disabled=!1)}var S=class{constructor(){this.bindEventListeners()}bindEventListeners(){document.addEventListener("click",this.handleClick.bind(this),!0),document.addEventListener("submit",this.handleSubmit.bind(this),!0)}handleClick(t){let e=t.target,n=e.closest("#client_create_confirm");if(n){this.handleClientCreateConfirm(n);return}let o=e.closest("#save_client_note_new");if(o){this.handleSaveClientNote(o);return}let i=e.closest(".client-note-delete-btn");if(i){this.handleDeleteClientNote(i);return}}handleSubmit(t){let e=t.target;if(e.id==="QuoteForm"){this.handleQuoteFormSubmit(t);return}if(e.id==="InvForm"){this.handleInvoiceFormSubmit(t);return}}async handleClientCreateConfirm(t){let e=`${location.origin}/invoice/client/create_confirm`,n=document.querySelector(".client_create_confirm")||t,o=new URL(location.href);n&&y(n,!0);try{let i={client_name:w("client_name"),client_surname:w("client_surname"),client_email:w("client_email")},s=await m(e,i),a=d(s);a.success===1?(n&&(n.innerHTML='<h2 class="text-center"><i class="fa fa-check"></i></h2>'),window.location.href=o.href,window.location.reload()):(n&&y(n,!1),console.warn("create_confirm response",a))}catch(i){console.warn(i),n&&y(n,!1),alert("An error occurred while creating client. See console for details.")}}async handleSaveClientNote(t){let e=`${location.origin}/invoice/client/save_client_note_new`,n=`${location.origin}/invoice/client/load_client_notes`,o=document.querySelector(".save_client_note")||t,i=new URL(location.href);o&&y(o,!0);try{let s={client_id:w("client_id"),client_note:w("client_note")},a=await m(e,s),l=d(a);if(l.success===1){o&&(o.innerHTML='<h2 class="text-center"><i class="fa fa-check"></i></h2>');let c=document.getElementById("client_note");c&&(c.value="");let u=document.getElementById("notes_list");if(u){let h=`${n}?client_id=${encodeURIComponent(s.client_id)}`;try{let _=await(await fetch(h,{cache:"no-store",credentials:"same-origin"})).text();if(_&&!_.includes("<!DOCTYPE")&&!_.includes("<html"))u.innerHTML=_;else{console.warn("Received full page HTML instead of notes fragment, reloading page"),window.location.reload();return}}catch(E){console.error("load_client_notes failed",E),window.location.reload();return}}setTimeout(()=>{o&&y(o,!1,'<h6 class="text-center"><i class="fa fa-save"></i></h6>')},1e3)}else this.clearValidationErrors(),l.validation_errors&&this.showValidationErrors(l.validation_errors),o&&y(o,!1)}catch(s){console.warn(s),o&&y(o,!1),alert("An error occurred while saving client note. See console for details.")}}async handleDeleteClientNote(t){let e=t.getAttribute("data-note-id");if(!e){console.error("No note ID found on delete button");return}if(!confirm("Are you sure you want to delete this note?"))return;let n=`${location.origin}/invoice/client/delete_client_note`,o=t.innerHTML;try{t.innerHTML='<i class="fa fa-spin fa-spinner"></i>',t.disabled=!0;let i=await fetch(`${n}?note_id=${encodeURIComponent(e)}`,{method:"GET",credentials:"same-origin"});if(i.ok){let s=await i.json();if(s.success===1){let a=t.closest(".panel");a&&a.remove()}else t.innerHTML=o,t.disabled=!1,alert(s.message||"Failed to delete note. Please try again.")}else{let s=await i.text();console.error("Delete client note HTTP error:",{status:i.status,statusText:i.statusText,body:s.substring(0,500)}),t.innerHTML=o,t.disabled=!1,alert("Failed to delete note. Please try again.")}}catch(i){console.error("Delete client note error:",i),t.innerHTML=o,t.disabled=!1,alert("An error occurred while deleting the note. Please try again.")}}clearValidationErrors(){document.querySelectorAll(".control-group").forEach(t=>{t.classList.remove("error")})}showValidationErrors(t){Object.keys(t).forEach(e=>{let n=document.getElementById(e);n?.parentElement&&n.parentElement.classList.add("has-error")})}async handleQuoteFormSubmit(t){t.preventDefault();let e=t.target,n=e.querySelector('button[type="submit"]'),o=n?.innerHTML;n&&y(n,!0),n&&(n.innerHTML='<i class="fa fa-check"></i>');let i=document.getElementById("modal-add-quote")||document.getElementById("modal-add-client");if(i){let s=window.bootstrap?.Modal?.getInstance(i);s&&s.hide()}setTimeout(()=>{e.submit()},300)}async handleInvoiceFormSubmit(t){t.preventDefault();let e=t.target,n=e.querySelector('button[type="submit"]'),o=n?.innerHTML;n&&y(n,!0),n&&(n.innerHTML='<i class="fa fa-check"></i>');let i=document.getElementById("modal-add-inv")||document.getElementById("modal-add-client");if(i){let s=window.bootstrap?.Modal?.getInstance(i);s&&s.hide()}setTimeout(()=>{e.submit()},300)}};function I(r,t,e){t?(r.innerHTML='<h2 class="text-center"><i class="fa fa-spin fa-spinner"></i></h2>',r.disabled=!0):(r.innerHTML=e||'<h2 class="text-center"><i class="fa fa-check"></i></h2>',r.disabled=!1)}function v(r){return document.getElementById(r)?.value||""}var x=class{constructor(){this.bindEventListeners()}bindEventListeners(){document.addEventListener("click",this.handleClick.bind(this),!0),document.addEventListener("change",this.handleChange.bind(this),!0),this.initializeAllClientsCheck()}handleChange(t){let e=t.target,n=e.closest('[name="checkbox-selection-all"]');if(n){this.handleSelectAllCheckboxes(n.checked);return}if(e.closest("#user_all_clients")){this.handleAllClientsCheck();return}}handleClick(t){let e=t.target;if(f(e,"#btn-mark-as-sent")){this.handleMarkAsSent();return}if(f(e,"#btn-mark-sent-as-draft")){this.handleMarkSentAsDraft();return}let i=f(e,".create_recurring_confirm_multiple");if(i){this.handleCreateRecurringMultiple(i);return}let s=f(e,".delete-items-confirm-inv")||f(e,"#delete-items-confirm-inv");if(s){this.handleDeleteInvoiceItems(s);return}let a=f(e,".modal_copy_inv_multiple_confirm");if(a){this.handleCopyMultipleInvoices(a);return}let l=f(e,"#inv_to_inv_confirm")||f(e,".inv_to_inv_confirm");if(l){this.handleCopySingleInvoice(l);return}let c=f(e,"#inv_tax_submit");if(c){t.preventDefault(),this.handleAddInvoiceTax(c);return}if(f(e,"#inv_to_pdf_confirm_with_custom_fields")){this.handlePdfExport(!0);return}if(f(e,"#inv_to_pdf_confirm_without_custom_fields")){this.handlePdfExport(!1);return}if(f(e,"#inv_to_modal_pdf_confirm_with_custom_fields")){this.handleModalPdfView(!0);return}if(f(e,"#inv_to_modal_pdf_confirm_without_custom_fields")){this.handleModalPdfView(!1);return}if(f(e,"#inv_to_html_confirm_with_custom_fields")){this.handleHtmlExport(!0);return}if(f(e,"#inv_to_html_confirm_without_custom_fields")){this.handleHtmlExport(!1);return}if(f(e,"#btn_modal_payment_submit")){this.handlePaymentSubmit();return}if(f(e,".btn_add_row_modal")){this.handleAddRowModal();return}if(f(e,".btn_inv_item_add_row")){this.handleAddInvoiceItemRow();return}let O=f(e,".btn_delete_item");if(O){this.handleDeleteSingleItem(O);return}}getCheckedInvoiceIds(){let t=[],e=document.getElementById("table-invoice");return e&&e.querySelectorAll('input[type="checkbox"]:checked').forEach(o=>{o.id&&t.push(o.id)}),t}async handleMarkAsSent(){let t=document.getElementById("btn-mark-as-sent"),e=t?.innerHTML;t&&I(t,!0);try{let n=this.getCheckedInvoiceIds(),o=`${location.origin}/invoice/inv/mark_as_sent`,i=await m(o,{keylist:n});d(i).success===1?(t&&(t.innerHTML='<h2 class="text-center"><i class="fa fa-check"></i></h2>'),window.location.reload()):(t&&(t.innerHTML='<h2 class="text-center"><i class="fa fa-times"></i></h2>'),window.location.reload())}catch(n){console.error("mark_as_sent error",n),t&&e&&I(t,!1,e),alert("An error occurred. See console for details.")}}async handleMarkSentAsDraft(){let t=document.getElementById("btn-mark-sent-as-draft"),e=t?.innerHTML;t&&I(t,!0);try{let n=this.getCheckedInvoiceIds(),o=`${location.origin}/invoice/inv/mark_sent_as_draft`,i=await m(o,{keylist:n});d(i).success===1?(t&&(t.innerHTML='<h2 class="text-center"><i class="fa fa-check"></i></h2>'),window.location.reload()):(t&&(t.innerHTML='<h2 class="text-center"><i class="fa fa-times"></i></h2>'),window.location.reload())}catch(n){console.error("mark_sent_as_draft error",n),t&&e&&I(t,!1,e),alert("An error occurred. See console for details.")}}async handleCreateRecurringMultiple(t){let e=document.querySelector(".create_recurring_confirm_multiple")||t,n=e?.innerHTML;e&&(e.innerHTML='<h6 class="text-center"><i class="fa fa-spin fa-spinner"></i></h6>',e.disabled=!0);try{let o=this.getCheckedInvoiceIds();if(o.length===0){alert("Please select invoices to create recurring invoices."),e&&n&&(e.innerHTML=n,e.disabled=!1);return}let i={keylist:o,recur_frequency:v("recur_frequency"),recur_start_date:v("recur_start_date"),recur_end_date:v("recur_end_date")};if(!i.recur_frequency||!i.recur_start_date){alert("Please select frequency and start date."),e&&n&&(e.innerHTML=n,e.disabled=!1);return}let s=`${location.origin}/invoice/invrecurring/multiple`,a=await m(s,i),l=d(a);if(l.success===1)e&&(e.innerHTML='<h2 class="text-center"><i class="fa fa-check"></i></h2>'),this.closeModal("create-recurring-multiple"),setTimeout(()=>{window.location.reload()},500);else{e&&(e.innerHTML='<h2 class="text-center"><i class="fa fa-times"></i></h2>');let c=l.message||"Failed to create recurring invoices. Please try again.";alert(c),e&&n&&(e.innerHTML=n,e.disabled=!1)}}catch(o){console.error("invrecurring/multiple error",o),e&&n&&(e.innerHTML=n,e.disabled=!1),alert("An error occurred while creating recurring invoices. See console for details.")}}async handleCopyMultipleInvoices(t){let e=document.querySelector(".modal_copy_inv_multiple_confirm")||t,n=e?.innerHTML;e&&(e.innerHTML='<h2 class="text-center"><i class="fa fa-spin fa-spinner"></i></h2>',e.disabled=!0);try{let o=v("modal_created_date"),i=this.getCheckedInvoiceIds();if(i.length===0){alert("Please select invoices to copy."),e&&n&&(e.innerHTML=n,e.disabled=!1);return}let s={keylist:i,modal_created_date:o},a=`${location.origin}/invoice/inv/multiplecopy`,l=await m(a,s);d(l).success===1?(e&&(e.innerHTML='<h2 class="text-center"><i class="fa fa-check"></i></h2>'),window.location.reload()):(e&&(e.innerHTML='<h2 class="text-center"><i class="fa fa-times"></i></h2>'),window.location.reload())}catch(o){console.error("multiplecopy error",o),e&&n&&(e.innerHTML=n,e.disabled=!1),alert("An error occurred. See console for details.")}}async handleAddInvoiceTax(t){let e=document.getElementById("inv_tax_submit"),n=e?.innerHTML;e&&(e.innerHTML='<i class="fa fa-spin fa-spinner"></i>',e.disabled=!0);try{let s={inv_id:new URL(location.href).pathname.split("/").pop()||"",inv_tax_rate_id:v("inv_tax_rate_id"),include_inv_item_tax:v("include_inv_item_tax")},a=`${location.origin}/invoice/inv/save_inv_tax_rate`,l=await m(a,s);d(l).success===1?(e&&(e.innerHTML='<i class="fa fa-check"></i>'),this.closeModal("add-inv-tax"),setTimeout(()=>{window.location.reload()},500)):(e&&(e.innerHTML='<i class="fa fa-times"></i>'),alert("Failed to add invoice tax. Please try again."),e&&n&&(e.innerHTML=n,e.disabled=!1))}catch(o){console.error("invoice tax add error",o),e&&n&&(e.innerHTML=n,e.disabled=!1),alert("An error occurred while adding invoice tax. See console for details.")}}async handleCopySingleInvoice(t){let e=document.querySelector(".inv_to_inv_confirm")||t,n=e?.innerHTML;e&&(e.innerHTML='<h6 class="text-center"><i class="fa fa-spin fa-spinner"></i></h6>',e.disabled=!0);try{let o=new URL(location.href),s={inv_id:o.pathname.split("/").pop()||"",client_id:v("create_inv_client_id"),user_id:v("user_id")},a=`${location.origin}/invoice/inv/inv_to_inv_confirm`,l=await m(a,s),c=d(l);c.success===1?(e&&(e.innerHTML='<h2 class="text-center"><i class="fa fa-check"></i></h2>'),c.new_invoice_id?window.location.href=`${location.origin}/invoice/inv/view/${c.new_invoice_id}`:(window.location.href=o.href,window.location.reload())):(e&&(e.innerHTML='<h2 class="text-center"><i class="fa fa-times"></i></h2>'),window.location.href=o.href,window.location.reload())}catch(o){console.error("inv_to_inv_confirm error",o),e&&n&&(e.innerHTML=n,e.disabled=!1),alert("An error occurred. See console for details.")}}async handleDeleteInvoiceItems(t){let e=document.querySelector(".delete-items-confirm-inv")||t,n=e?.innerHTML;e&&(e.innerHTML='<i class="fa fa-spin fa-spinner"></i>',e.disabled=!0);try{let o=[],i=document.getElementById("delete-items");i&&i.querySelectorAll('input[type="checkbox"]:checked').forEach(_=>{_.value&&o.push(_.value)});let a=new URL(location.href).pathname.split("/").pop()||"";if(o.length===0){alert("Please select items to delete."),e&&n&&(e.innerHTML=n,e.disabled=!1);return}let l={item_ids:o,inv_id:a},c=`${location.origin}/invoice/invitem/multiple`,u=await m(c,l);d(u).success===1?(e&&(e.innerHTML='<i class="fa fa-check"></i>'),this.closeModal("delete-items"),setTimeout(()=>{window.location.reload()},500)):(e&&(e.innerHTML='<i class="fa fa-times"></i>'),alert("Failed to delete items. Please try again."),e&&n&&(e.innerHTML=n,e.disabled=!1))}catch(o){console.error("delete items error",o),e&&n&&(e.innerHTML=n,e.disabled=!1),alert("An error occurred while deleting items. See console for details.")}}handlePdfExport(t){let e=t?"1":"0",n=`${location.origin}/invoice/inv/pdf/${e}`;window.open(n,"_blank")}handleModalPdfView(t){let e=t?"1":"0",n=`${location.origin}/invoice/inv/pdf/${e}`,o=document.getElementById("modal-view-inv-pdf");o&&(o.src=n);try{if(typeof window.bootstrap?.Modal<"u"){let i=document.getElementById("modal-layout-modal-pdf-inv");i&&new window.bootstrap.Modal(i).show()}}catch(i){console.warn("Failed to open PDF modal:",i)}}handleHtmlExport(t){let e=t?"1":"0",n=`${location.origin}/invoice/inv/html/${e}`;window.open(n,"_blank")}async handlePaymentSubmit(){let t=`${location.origin}/invoice/payment/add_with_ajax`,e=document.getElementById("btn_modal_payment_submit"),n=e?.innerHTML;e&&(e.innerHTML='<i class="fa fa-spin fa-spinner"></i>',e.disabled=!0);try{let o={amount:v("payment_amount"),payment_method:v("payment_method"),payment_date:v("payment_date")},i=await m(t,o);d(i).success===1?(e&&(e.innerHTML='<i class="fa fa-check"></i>'),this.closeModal("payment-modal"),setTimeout(()=>{window.location.reload()},500)):(e&&n&&(e.innerHTML=n,e.disabled=!1),alert("Failed to process payment. Please try again."))}catch(o){console.error("Payment submission error:",o),e&&n&&(e.innerHTML=n,e.disabled=!1),alert("An error occurred while processing payment. See console for details.")}}handleAddRowModal(){let e=new URL(location.href).pathname.split("/").pop()||"",n=`${location.origin}/invoice/invitem/add/${e}`,o=document.getElementById("modal-placeholder-invitem");o&&fetch(n,{credentials:"same-origin"}).then(i=>i.text()).then(i=>{o.innerHTML=i}).catch(i=>{console.error("Failed to load modal content:",i),alert("Failed to load item form. Please try again.")})}handleAddInvoiceItemRow(){let t=document.getElementById("new_row"),e=document.getElementById("item_table");if(t&&e){let n=t.cloneNode(!0);n.removeAttribute("id"),n.classList.add("item"),n.style.display="block",e.appendChild(n)}}async handleDeleteSingleItem(t){let e=t.getAttribute("data-id");if(!e){let n=t.closest(".item");n&&n.remove();return}try{let n=`${location.origin}/invoice/inv/delete_item/${e}`,o=await m(n,{id:e});if(d(o).success===1){let s=t.closest(".item");s&&s.remove(),alert("Deleted"),window.location.reload()}else alert("Failed to delete item. Please try again.")}catch(n){console.error("Delete item error:",n),alert("An error occurred while deleting the item. Please try again.")}}handleSelectAllCheckboxes(t){document.querySelectorAll('input[type="checkbox"]').forEach(n=>{n.checked=t})}initializeAllClientsCheck(){this.handleAllClientsCheck()}handleAllClientsCheck(){let t=document.getElementById("user_all_clients"),e=document.getElementById("list_client");t&&e&&(t.checked?e.style.display="none":e.style.display="block")}closeModal(t){try{if(typeof window.bootstrap?.Modal<"u"){let e=document.getElementById(t);if(e){let n=window.bootstrap.Modal.getInstance(e);n&&n.hide()}}}catch(e){console.warn("Failed to close modal:",e)}}};function U(r,t){r.forEach(e=>{t?e.innerHTML='<h6 class="text-center"><i class="fa fa-spin fa-spinner"></i></h6>':e.innerHTML='<h6 class="text-center"><i class="fa fa-check"></i></h6>'})}function z(r){r.forEach(t=>{t.innerHTML='<h6 class="text-center"><i class="fa fa-error"></i></h6>'})}var q=class{constructor(){this.bindEventListeners(),this.exposeGlobalFunctions()}bindEventListeners(){document.addEventListener("click",this.handleClick.bind(this),!0)}handleClick(t){t.target.closest("#product_filters_submit")&&this.submitProductFilters(t)}filterTableBySku(){let t=document.getElementById("filter_product_sku");if(!t)return;let n=(t.value||"").toUpperCase(),o=document.getElementById("table-product");if(!o)return;let i=o.getElementsByTagName("tr");for(let s=0;s<i.length;s++){let a=i[s].getElementsByTagName("td")[2];a&&((a.textContent||a.innerText||"").toUpperCase().indexOf(n)>-1?i[s].style.display="":i[s].style.display="none")}}async submitProductFilters(t){t?.preventDefault&&t.preventDefault();let e=`${location.origin}/invoice/product/search`,n=document.querySelectorAll(".product_filters_submit");U(n,!0);try{let s={product_sku:document.getElementById("filter_product_sku")?.value||""},a=await m(e,s),l=d(a);l.success===1?(this.filterTableBySku(),this.hideSummaryBar(),U(n,!1)):(z(n),l.message&&alert(l.message))}catch(o){console.error("product search failed",o),z(n),alert("An error occurred while searching products. See console for details.")}}hideSummaryBar(){let t=document.querySelector(".mt-3.me-3.summary.text-end");t&&(t.style.visibility="hidden")}exposeGlobalFunctions(){window.productTableFilter=this.filterTableBySku.bind(this)}};var C=class{constructor(){this.bindEventListeners(),this.initializeOnLoad()}bindEventListeners(){document.addEventListener("click",this.handleClick.bind(this),!0)}initializeOnLoad(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{this.initSelects()}):this.initSelects()}handleClick(t){let e=t.target;if(e.matches("#salesorder_to_pdf_confirm_with_custom_fields")||e.closest("#salesorder_to_pdf_confirm_with_custom_fields")){this.handlePdfExport(!0);return}if(e.matches("#salesorder_to_pdf_confirm_without_custom_fields")||e.closest("#salesorder_to_pdf_confirm_without_custom_fields")){this.handlePdfExport(!1);return}if(e.matches("#so_to_invoice_confirm")||e.closest("#so_to_invoice_confirm")){this.handleSoToInvoiceConversion();return}let n=e.closest(".open-salesorder-modal");if(n){this.handleOpenModal(n);return}if(e.closest(".salesorder-save")){this.handleSaveSalesOrder();return}}initSelects(){if(typeof window.TomSelect>"u")return;document.querySelectorAll(".simple-select").forEach(e=>{if(!e._tomselect)try{new window.TomSelect(e,{}),e._tomselect=!0}catch(n){console.warn("Failed to initialize TomSelect:",n)}})}async handleOpenModal(t){let e=t.dataset.url||`${location.origin}/invoice/salesorder/modal`,n=t.dataset.target||"modal-placeholder-salesorder",o=document.getElementById(n);if(!o){console.error(`Modal target element not found: ${n}`);return}try{let s=await(await fetch(e,{cache:"no-store",credentials:"same-origin"})).text();o.innerHTML=s;let a=o.querySelector(".modal");a&&window.bootstrap?.Modal&&new window.bootstrap.Modal(a).show(),this.initSelects()}catch(i){console.error("Failed to load sales order modal:",i),alert("Failed to load modal. Please try again.")}}handlePdfExport(t){let e=location.origin+"/invoice/salesorder/pdf/"+(t?"1":"0");window.location.reload(),window.open(e,"_blank")}async handleSoToInvoiceConversion(){let t=document.querySelector(".so_to_invoice_confirm");t&&(t.innerHTML='<i class="fa fa-spin fa-spinner fa-margin"></i>');let e=document.getElementById("so_id"),n=document.getElementById("client_id"),o=document.getElementById("group_id"),i=document.getElementById("password");if(!e?.value||!n?.value||!o?.value){console.error("Required fields missing for SO to Invoice conversion"),alert("Missing required data for conversion");return}let s={so_id:e.value,client_id:n.value,group_id:o.value,password:i?.value||""};try{let a=location.origin+"/invoice/salesorder/so_to_invoice_confirm",l=await m(a,s);if(l&&l.success===1){t&&(t.innerHTML='<h2 class="text-center"><i class="fa fa-check"></i></h2>');let c=new URL(location.href);window.location.href=c.toString(),window.location.reload()}else l?.validation_errors&&(document.querySelectorAll(".control-group").forEach(c=>{c.classList.remove("error")}),Object.keys(l.validation_errors).forEach(c=>{let u=document.getElementById(c);u?.parentElement&&u.parentElement.classList.add("has-error")})),t&&(t.innerHTML='<h6 class="text-center"><i class="fa fa-check"></i></h6>')}catch(a){console.error("SO to Invoice conversion failed:",a),t&&(t.innerHTML='<h6 class="text-center"><i class="fa fa-check"></i></h6>'),alert("An error occurred during conversion. Please try again.")}}async handleSaveSalesOrder(){let t=document.querySelector("#salesorder_form");if(!t){console.error("Sales order form not found");return}try{let e=t.getAttribute("action")||`${location.origin}/invoice/salesorder/save`,n=new FormData(t),o=new URLSearchParams;n.forEach((c,u)=>{o.append(u,c.toString())});let i=`${e}?${o.toString()}`,a=await(await fetch(i,{cache:"no-store",credentials:"same-origin",headers:{Accept:"application/json"}})).json(),l=d(a);if(l.success===1)window.location.reload();else{let c=l.message||"Save failed";alert(c)}}catch(e){console.error("Sales order save failed:",e),alert("An error occurred while saving. Please try again.")}}};var k=class{constructor(){this.bindEventListeners()}bindEventListeners(){document.addEventListener("DOMContentLoaded",this.initializeSelectors.bind(this))}initializeSelectors(){let t=document.getElementById("family-category-primary-id"),e=document.getElementById("family-category-secondary-id");t&&(t.addEventListener("change",this.onPrimaryChange.bind(this),!1),Promise.resolve().then(()=>this.onPrimaryChange())),e&&(e.addEventListener("change",this.onSecondaryChange.bind(this),!1),Promise.resolve().then(()=>this.onSecondaryChange()))}populateSelect(t,e,n){if(!t)return;t.innerHTML="";let o=document.createElement("option");o.value="",o.textContent=n||"None",t.appendChild(o),e&&(Array.isArray(e)?e.forEach((i,s)=>{let a=document.createElement("option");a.value=s.toString(),a.textContent=i,t.appendChild(a)}):Object.entries(e).forEach(([i,s])=>{let a=document.createElement("option");a.value=i,a.textContent=s,t.appendChild(a)}))}async onPrimaryChange(){let t=document.getElementById("family-category-primary-id");if(!t)return;let e=t.value||"",n=`${location.origin}/invoice/family/secondaries/${encodeURIComponent(e)}`;try{let i=await m(n,{category_primary_id:e}),s=d(i);if(s.success===1){let a=s.secondary_categories||{},l=document.getElementById("family-category-secondary-id");if(this.populateSelect(l,a,"None"),l){let c=new Event("change",{bubbles:!0});l.dispatchEvent(c)}}else this.populateSelect(document.getElementById("family-category-secondary-id"),{},"None"),this.populateSelect(document.getElementById("family-name"),{},"None")}catch(o){console.error("Error loading secondary categories",o),this.populateSelect(document.getElementById("family-category-secondary-id"),{},"None"),this.populateSelect(document.getElementById("family-name"),{},"None")}}async onSecondaryChange(){let t=document.getElementById("family-category-secondary-id");if(!t)return;let e=t.value||"",n=`${location.origin}/invoice/family/names/${encodeURIComponent(e)}`;try{let i=await m(n,{category_secondary_id:e}),s=d(i);if(s.success===1){let a=s.family_names||{},l=document.getElementById("family-name");this.populateSelect(l,a,"None")}else this.populateSelect(document.getElementById("family-name"),{},"None")}catch(o){console.error("Error loading family names",o),this.populateSelect(document.getElementById("family-name"),{},"None")}}};var R=class{constructor(){this.originalDisplayStyles={};this.originalDisabledStates={};this.bindEventListeners()}bindEventListeners(){document.addEventListener("DOMContentLoaded",this.initialize.bind(this))}initialize(){this.toggleSmtpSettings();let t=document.getElementById("email_send_method");t&&t.addEventListener("change",this.toggleSmtpSettings.bind(this));let e=document.getElementById("btn_fph_generate");e&&e.addEventListener("click",i=>{i.preventDefault(),this.handleFphGenerateClick()});let n=document.getElementById("btn-submit");n&&n.addEventListener("click",i=>{i.preventDefault(),this.handleSettingsSubmitClick()});let o=document.getElementById("online-payment-select");o&&o.addEventListener("change",this.handleOnlinePaymentSelectChange.bind(this)),this.handleOnlinePaymentSelectChange()}toggleSmtpSettings(){let t=document.getElementById("email_send_method"),e=document.getElementById("div-smtp-settings");!e||!t||(t.value==="smtp"?e.style.display="":e.style.display="none")}async handleFphGenerateClick(){let t=`${location.origin}/invoice/setting/fphgenerate`,e={userAgent:navigator.userAgent,width:window.screen.width,height:window.screen.height,scalingFactor:Math.round(window.devicePixelRatio*100)/100,colourDepth:window.screen.colorDepth,windowInnerWidth:window.innerWidth,windowInnerHeight:window.innerHeight},n=new URLSearchParams;Object.entries(e).forEach(([o,i])=>{n.append(o,i.toString())});try{let o=await fetch(`${t}?${n.toString()}`,{method:"GET",credentials:"same-origin",cache:"no-store",headers:{Accept:"application/json"}});if(!o.ok)throw new Error(`Network response not ok: ${o.status}`);let i=await o.json().catch(()=>({})),s=d(i);s.success===1&&(this.updateSettingField("settings[fph_client_browser_js_user_agent]",s.userAgent),this.updateSettingField("settings[fph_client_device_id]",s.deviceId),this.updateSettingField("settings[fph_screen_width]",s.width),this.updateSettingField("settings[fph_screen_height]",s.height),this.updateSettingField("settings[fph_screen_scaling_factor]",s.scalingFactor),this.updateSettingField("settings[fph_screen_colour_depth]",s.colourDepth),this.updateSettingField("settings[fph_timestamp]",s.timestamp),this.updateSettingField("settings[fph_window_size]",s.windowSize),this.updateSettingField("settings[fph_gov_client_user_id]",s.userUuid))}catch(o){console.error("FPH generate failed",o)}}updateSettingField(t,e){let n=document.getElementById(t);n&&e!==void 0&&(n.value=e)}handleSettingsSubmitClick(){let t=document.getElementById("form-settings");if(!t)return;let e=t.querySelectorAll(".tab-pane");this.originalDisplayStyles={},this.originalDisabledStates={},e.forEach(n=>{n.id&&(this.originalDisplayStyles[n.id]=n.style.display,n.style.display="block",n.querySelectorAll("input:disabled, select:disabled, textarea:disabled").forEach((i,s)=>{let a=`${n.id}_${s}`;this.originalDisabledStates[a]={element:i,disabled:!0},i.disabled=!1}))}),setTimeout(()=>{t.submit(),this.restoreFormState(e)},10)}restoreFormState(t){t.forEach(e=>{e.id&&this.originalDisplayStyles[e.id]!==void 0&&(e.style.display=this.originalDisplayStyles[e.id])}),Object.entries(this.originalDisabledStates).forEach(([e,n])=>{n.element&&n.disabled&&(n.element.disabled=!0)})}handleOnlinePaymentSelectChange(){let t=document.getElementById("online-payment-select");if(!t)return;let e=t.value;document.querySelectorAll(".gateway-settings").forEach(i=>{i.classList.contains("active-gateway")||i.classList.add("hidden")});let o=document.getElementById(`gateway-settings-${e}`);o&&(o.classList.remove("hidden"),o.classList.add("active-gateway"))}};function P(){let r=window.bootstrap;if(typeof r>"u"||!r.Tooltip)return;document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(e=>{try{new r.Tooltip(e)}catch{}})}function B(r){let t=window.TomSelect;if(typeof t>"u")return;(r||document).querySelectorAll(".simple-select").forEach(o=>{o._tomselect||(new t(o,{}),o._tomselect=!0)})}function F(){let r=document.getElementById("fullpage-loader"),t=document.getElementById("loader-error"),e=document.getElementById("loader-icon");r&&(r.style.display="block"),t&&(t.style.display="none"),e&&(e.classList.add("fa-spin"),e.classList.remove("text-danger")),setTimeout(()=>{t&&(t.style.display="block"),e&&(e.classList.remove("fa-spin"),e.classList.add("text-danger"))},1e4)}function D(){let r=document.getElementById("fullpage-loader"),t=document.getElementById("loader-error"),e=document.getElementById("loader-icon");r&&(r.style.display="none"),t&&(t.style.display="none"),e&&(e.classList.add("fa-spin"),e.classList.remove("text-danger"))}function $(){let r=document.querySelector(".passwordmeter-input");r&&r.addEventListener("input",()=>{let t=r.value,e=Z(t),n=document.querySelector(".passmeter-2"),o=document.querySelector(".passmeter-3");n&&o&&(n.style.display="none",o.style.display="none",e>=4?(n.style.display="block",o.style.display="block"):e>=3&&(n.style.display="block"))})}function Z(r){let t=0;return r.length>=8&&t++,/[a-z]/.test(r)&&t++,/[A-Z]/.test(r)&&t++,/[0-9]/.test(r)&&t++,/[^A-Za-z0-9]/.test(r)&&t++,t}function K(){document.addEventListener("DOMContentLoaded",()=>{P(),B(),$(),document.addEventListener("click",r=>{let t=r.target;t.classList.contains("ajax-loader")&&F(),t.classList.contains("fullpage-loader-close")&&D()})})}K();console.log("Invoice TypeScript bundle loaded");var M=class{constructor(){this._createCreditHandler=new H,this._quoteHandler=new b,this._clientHandler=new S,this._invoiceHandler=new x,this._productHandler=new q,this._salesOrderHandler=new C,this._familyHandler=new k,this._settingsHandler=new R,this.initializeTooltips(),this.initializeTaggableFocus(),P(),B(),$(),this.initializeFullpageLoader(),console.log("Invoice TypeScript App initialized with all core handlers: Quote, Client, Invoice, Product, SalesOrder, Family, and Settings")}initializeTooltips(){document.addEventListener("DOMContentLoaded",()=>{typeof bootstrap<"u"&&bootstrap.Tooltip&&document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(e=>{try{new bootstrap.Tooltip(e)}catch(n){console.warn("Tooltip initialization failed:",n)}})})}initializeTaggableFocus(){document.addEventListener("focus",t=>{let e=t.target;e?.classList?.contains("taggable")&&(window.lastTaggableClicked=e)},!0)}initializeFullpageLoader(){document.addEventListener("click",t=>{let e=t.target;e.classList.contains("ajax-loader")&&F(),e.classList.contains("fullpage-loader-close")&&D()})}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>new M):new M;return J(X);})();
